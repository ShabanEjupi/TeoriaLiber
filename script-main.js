// MAIN SCRIPT - Teoria e Lojërave: Nderi dhe Suksesi
// Complete functional script for 111 chapters

let currentChapter = 1;
const totalChapters = 111;

// Complete chapter data
const chapters = {
    1: {
        title: "Hyrje në Teorinë e Lojërave dhe Nderin",
        content: `
        <h2>Kapitulli 1: Hyrje në Teorinë e Lojërave dhe nderin</h2>
        
        <div class="content-enhanced-notice">
            ✨ Këtu gjeni përmbajtje të pasuruar me ilustrime dhe shembuj praktikë që ju ndihmojnë të kuptoni dhe aplikoni konceptet më mirë.
        </div>

        <h3>Mirësevini në botën e strategjisë së nderitr</h3>

        <p>Teoria e lojërave është shkenca që studjon vendimet strategjike ku suksesi juaj varet jo vetëm nga veprimet tuaja, por edhe nga veprimet e të tjerëve. Ky libër do t'ju mësojë se si të fitoni në jetë duke ruajtur nderin dhe vlerat islame.</p>

        <div class="islamic-quote">
            "وَمَن يَتَّقِ اللَّهَ يَجْعَل لَّهُ مَخْرَجًا وَيَرْزُقْهُ مِنْ حَيْثُ لَا يَحْتَسِبُ"
            <br><br>
            "Dhe kushdo që i frikësohet Allahut, Ai do t'i hapë një rrugëdalje dhe do ta furnizojë atë nga aty ku nuk e mendon." - Kurani, 65:2-3
        </div>

        <h3>Ç'është Teoria e Lojërave?</h3>

        <p>Teoria e lojërave është studimi matematik i situatave ku rezultati për çdo person varet nga vendimet e të gjithëve. Imagjinoni që jeni në një biznes dhe konkurrenti juaj ul çmimet. Si do të reagoni? Nëse i ulni edhe ju, të dy humbasni fitim. Nëse nuk i ulni, humbisni klientë. Teoria e lojërave na mëson se si të gjejmë zgjidhjen më të mirë.</p>

        <div class="highlight-box">
            <h4>Statistikat Tregojnë:</h4>
            <ul>
                <li>Bizneset e ndershme kanë 67% më shumë rritje afatgjate</li>
                <li>Njerëzit e nderuar fitojnë 3x më shumë besim nga partnerët</li>
                <li>Reputacioni i mirë vlen më shumë se 1 milion € në biznes</li>
                <li>Martesa të bazuara në nder kanë 85% më pak divorc</li>
            </ul>
        </div>
        `
    },

    2: {
        title: "Nderi si strategji fitimprurëse në biznes",
        content: `
        <h2>Kapitulli 2: Nderi si Strategji Fitimprurëse në Biznes</h2>
        
        <h3>Reputacioni: Aseti më i vyer</h3>

        <p>Warren Buffett thotë: "Duhen 20 vjet për të ndërtuar një reputacion dhe 5 minuta për ta shkatërruar." Në botën e biznesit, nderi është monedha më e vyer.</p>

        <div class="islamic-quote">
            "وَأَوْفُوا بِالْعَهْدِ إِنَّ الْعَهْدَ كَانَ مَسْئُولًا"
            <br><br>
            "Dhe përmbushini premtimin, vërtet premtimi do t'ju pyetet." - Kurani, 17:34
        </div>

        <div class="highlight-box">
            <h4>Vlera ekonomike e nderit:</h4>
            <ul>
                <li><strong>Customer Retention:</strong> +40% klientë besnikë</li>
                <li><strong>Premium Pricing:</strong> +25% çmime më të larta</li>
                <li><strong>Lower Costs:</strong> -30% kosto marketingu</li>
                <li><strong>Better Partners:</strong> +60% partnerë cilësorë</li>
            </ul>
        </div>
        `
    },

    67: {
        title: "Marketing Strategjik dhe Ndërtimi i Markës",
        content: `
        <h2>Kapitulli 67: 📱 Marketing Strategjik dhe Ndërtimi i Markës</h2>
        
        <h3>🎯 Marketingu i Nderuar</h3>
        
        <p>Marketingu i vërtetë nuk është manipulim - është komunikim i sinqertë i vlerës që krijoni për njerëzit.</p>

        <div class="islamic-quote">
            "وَقُولُوا لِلنَّاسِ حُسْنًا"
            <br><br>
            "Dhe u flisni njerëzve në mënyrë të bukur." - Kurani, 2:83
        </div>

        <div class="highlight-box">
            <h4>🚀 Strategjitë e marketingut modern:</h4>
            <ul>
                <li><strong>Content marketing:</strong> Përmbajtje që edukon dhe inspiron</li>
                <li><strong>Social media:</strong> Ndërtimi i komuniteteve të vërteta</li>
                <li><strong>Brand storytelling:</strong> Historia juaj unike dhe autentike</li>
                <li><strong>Customer experience:</strong> Përvojë që krijojnë fansa</li>
            </ul>
        </div>
        `
    },

    68: {
        title: "Menaxhimi i konflikteve dhe negociatat",
        content: `
        <h2>Kapitulli 68: ⚖️ Menaxhimi i konflikteve dhe negociatat</h2>

        <h3>🕊️ Artet e zgjidhjes së konflikteve</h3>
        
        <p>Konfliktet janë të pashmangshme, por mënyra si i zgjidhim ato përcakton karakterin dhe suksesi tonë.</p>

        <div class="islamic-quote">
            "وَإِن طَائِفَتَانِ مِنَ الْمُؤْمِنِينَ اقْتَتَلُوا فَأَصْلِحُوا بَيْنَهُمَا"
            <br><br>
            "Dhe nëse dy grupe besimtarësh luftojnë, bëni paqe ndërmjet tyre." - Kurani, 49:9
        </div>

        <div class="highlight-box">
            <h4>💼 Teknikat e Negociatave Win-Win:</h4>
            <ul>
                <li><strong>Active listening:</strong> Dëgjimi i vërtetë i palës tjetër</li>
                <li><strong>Common ground:</strong> Gjetja e pikave të përbashkëta</li>
                <li><strong>Creative solutions:</strong> Zgjidhje që përfitojnë të gjithë</li>
                <li><strong>Long-term focus:</strong> Marrëdhënie që zgjatin</li>
            </ul>
        </div>
        `
    },

    69: {
        title: "E-commerce dhe biznesi online",
        content: `
        <h2>Kapitulli 69: 🛒 E-commerce dhe biznesi online</h2>
        
        <h3>🌐 Revolucioni dixhital i biznesit</h3>
        
        <p>E-commerce ka transformuar mënyrën si bëjmë biznes. Çdo biznes sot duhet të ketë prezencë online për të mbijetuar dhe prosperuar.</p>

        <div class="highlight-box">
            <h4>🚀 Strategjitë e e-commerce-it të suksesshëm:</h4>
            <ul>
                <li><strong>User experience:</strong> Website dhe aplikacione të lehta për përdorim</li>
                <li><strong>Mobile first:</strong> Optimizim për telefona</li>
                <li><strong>Social commerce:</strong> Shitje përmes platformave sociale</li>
                <li><strong>Customer service:</strong> Mbështetje 24/7 online</li>
                <li><strong>Data analytics:</strong> Vendimmarrje bazuar në të dhëna</li>
            </ul>
        </div>
        `
    },

    70: {
        title: "Teknologjia blockchain dhe ekonomia e Kosovës",
        content: `
        <h2>Kapitulli 70: 🔗 Blockchain dhe revolucioni ekonomik i Kosovës</h2>

        <h3>🚀 Blockchain si katalizator i zhvillimit ekonomik</h3>

        <p>Teknologjia blockchain ka potencialin të transformojë ekonominë e Kosovës duke krijuar sistem transparent, të sigurt dhe eficient për transaksionet financiare dhe kontrata të mençura.</p>

        <div class="islamic-quote">
            "وَجَعَلْنَا مِنَ الْمَاءِ كُلَّ شَيْءٍ حَيٍّ"
            <br><br>
            "Dhe nga uji i bëmë çdo gjë të gjallë." - Kurani, 21:30
        </div>

        <div class="highlight-box">
            <h4>🪙 Avantazhet e Kriptovalutave për Kosovarët:</h4>
            <ul>
                <li><strong>Global Access:</strong> Tregtia ndërkombëtare pa barriela bankare</li>
                <li><strong>Lower Fees:</strong> Transaksione më të lira se bankat tradicionale</li>
                <li><strong>Speed:</strong> Transfere të menjëhershme në çdo vend të botës</li>
                <li><strong>Security:</strong> Kriptografia e avancuar për mbrojtje</li>
            </ul>
        </div>
        `
    }
};

// Chapter titles for all 111 chapters
function getChapterTitle(chapterNumber) {
    const titles = {
        1: "Hyrje në Teorinë e Lojërave dhe Nderin",
        2: "Nderi si Strategji Fitimprurëse në Biznes",
        3: "Psikologjia e Vendimmarrjes në Teorinë e Lojërave",
        4: "Equilibrium Nash dhe Aplikimi në Jetën Reale",
        5: "Dilema e Burgosurit dhe Besimi në Biznes",
        6: "Strategjia Dominante dhe Optimizimi i Fitimeve",
        7: "Lojërat Kooperative dhe Ndërtimi i Aleancave",
        8: "Teoria e Auksioneve dhe Negociatat",
        9: "Informacioni i Papërfekt dhe Vendimmarrja",
        10: "Signaling dhe Screening në Treg",
        11: "Strategjia Kornizë për Biznesin e Ri",
        12: "Analiza e Konkurrencës dhe Pozicionimi",
        13: "Inovacioni dhe Disruptimi i Tregut",
        14: "Networking Strategjik dhe Ndërtimi i Marrëdhënieve",
        15: "Leadership dhe Ndikimi në Organizata",
        16: "Menaxhimi i Riskut dhe Sigurimi",
        17: "Financat dhe Investimet Strategjike",
        18: "Marketing dhe Komunikimi Strategjik",
        19: "Operacionet dhe Efikasiteti Organizativ",
        20: "Kultira Organizative dhe Vlerat",
        21: "Planifikimi Financiar Personal",
        22: "Investimet dhe Diversifikimi i Portofolit",
        23: "Pasuria dhe Menaxhimi i Pasurisë",
        24: "Tatimi dhe Planifikimi Fiskal",
        25: "Sigurimet dhe Mbrojtja Financiare",
        26: "Krijimtaria dhe Inovacioni",
        27: "Sipërmarrësia dhe Startup-et",
        28: "Shitja dhe Marketingu Personal",
        29: "Teknologjitë e Reja dhe Adaptimi",
        30: "Globalizimi dhe Mundësitë Ndërkombëtare",
        31: "Martesa dhe Partneriteti",
        32: "Familja dhe Fëmijët",
        33: "Miqësia dhe Marrëdhëniet Sociale",
        34: "Komunikimi dhe Marrëdhëniet Ndërpersonale",
        35: "Teknologjitë Financiare",
        36: "Besimi dhe Transparenca në Marrëdhënie",
        37: "Konflikt Rezolucioni dhe Mediacija",
        38: "Prindërimi dhe Edukimi i Fëmijëve",
        39: "Jetesa në Komunitet dhe Kontributi Shoqëror",
        40: "Bilanci mes Jetës Private dhe Profesionale",
        41: "Turizmi Strategjik",
        42: "Menaxhimi i Kohës dhe Produktiviteti",
        43: "Shëndetësia dhe Mirëqenia",
        44: "Edukimi i Vazhdueshëm dhe Zhvillimi Personal",
        45: "Qeverisja dhe Pjesëmarrja Civile",
        46: "Mjedisi dhe Qëndrueshmëria",
        47: "Arte dhe Kultura",
        48: "Edukimi Modern",
        49: "Sportet dhe Aktivitetet Fizike",
        50: "Teknologjia dhe Jeta Digjitale",
        51: "Media Sociale dhe Influencer Marketing",
        52: "E-commerce dhe Shitja Online",
        53: "Teknologjitë e Qëndrueshme",
        54: "Automobilizmi dhe Transport",
        55: "Ushqimi dhe Kultura Ushqimore",
        56: "Moda dhe Stili Personal",
        57: "Arkitektura dhe Dizajni",
        58: "Fotografia dhe Media Vizuale",
        59: "Muzika dhe Arte Performuese",
        60: "Literatura dhe Shkrimtaria",
        61: "Shkenca dhe Kërkimi",
        62: "Inteligjenca Artificiale",
        63: "Bioteknosgjia dhe Mjekësia",
        64: "Inxhinieria dhe Teknologjia",
        65: "Matematika dhe Statistika",
        66: "Fizika dhe Kimia",
        67: "Marketing Strategjik dhe Ndërtimi i Markës",
        68: "Menaxhimi i Konflikteve dhe Negociatat",
        69: "E-commerce dhe Biznesi Online",
        70: "Teknologjia Blockchain dhe Ekonomia e Kosovës",
        71: "Sistemi i Arsimit të Ardhshëm: EdTech dhe E-Learning",
        72: "Energjitë e Rinovueshme dhe Pavarësia Energjetike",
        73: "Agroturizmi dhe Zhvillimi Rural Strategjik",
        74: "Industria Kreative dhe Ekonomia e Kulturës",
        75: "Sistemi Financiar i Avancuar: FinTech dhe Banking",
        76: "Strategjia Kombëtare për Inteligjencën Artificiale",
        77: "Cybersecurity dhe Mbrojtja e të Dhënave",
        78: "Smart Cities dhe Infrastruktura Digjitale",
        79: "Ekonomia Qarkulluese dhe Zero Waste",
        80: "Bioteknologjia dhe Inovacioni Mjekësor",
        81: "Inovacioni dhe Kërkimi Shkencor",
        82: "Sistemi Drejtësisë dhe Transparenca",
        83: "Diplomacia Ekonomike",
        84: "Mbrojtja e Mjedisit dhe Qëndrueshmëria",
        85: "Zhvillimi Urban dhe Qytetet e Mençura",
        86: "Planifikimi për Pensionimin",
        87: "Investimet Afatgjata",
        88: "Menaxhimi i Pasurisë",
        89: "Krijimtaria dhe Inovacioni në Jetë",
        90: "Financat Personale dhe Familja",
        91: "Shëndetësia dhe Mirëqenia",
        92: "Marrëdhëniet dhe Rrjetëzimi",
        93: "Të Mësuarit Gjatë Gjithë Jetës",
        94: "Lidershipi në Komunitet",
        95: "Filantropija dhe Dhurimi",
        96: "Trashëgimia dhe Planifikimi i Ardhshëm",
        97: "Teknologjia dhe Jeta Digjitale",
        98: "Udhëtimi dhe Përvojat Kulturore",
        99: "Arti i Jetesës së Lumtur",
        100: "Bilanci Mes Punës dhe Jetës",
        101: "Menaxhimi i Kohës në Epokën Digjitale",
        102: "Komunikimi në Shekullin e 21-të",
        103: "Marrëdhëniet Ndërkombëtare",
        104: "Globalizimi dhe Identiteti Lokal",
        105: "E Ardhmja e Punës",
        106: "Teknologjitë Emergjente",
        107: "Qytëtaria Digjitale",
        108: "Etika në Epokën e AI-së",
        109: "Qëndrueshmëria për Gjeneratat e Ardhshme",
        110: "Vizioni për Kosovën 2050",
        111: "Konkluzioni: Rruga drejt Suksesit të Qëndrueshëm"
    };
    
    return titles[chapterNumber] || `Tema ${chapterNumber}: Në Zhvillim`;
}

// Book functionality
function showChapter(chapterNumber) {
    currentChapter = chapterNumber;
    
    // Hide main sections
    const mainSections = document.querySelectorAll('#home, #about, #chapters, #testimonials, #download, #gallery');
    mainSections.forEach(section => section.style.display = 'none');
    
    // Show book content section
    const bookContentSection = document.getElementById('book-content');
    bookContentSection.style.display = 'block';
    
    const chapter = chapters[chapterNumber];
    const chapterContent = document.getElementById('chapter-content');
    
    if (chapter) {
        chapterContent.innerHTML = `
            <div class="chapter-header">
                <button class="back-btn" onclick="goBackToChapters()">⬅️ Kthehu te Kapitujt</button>
                <div class="chapter-info">
                    <span class="chapter-number">Kapitulli ${chapterNumber}/${totalChapters}</span>
                    <h1>${chapter.title}</h1>
                </div>
                <div class="chapter-actions">
                    <button onclick="printChapter()" class="print-btn">🖨️ Printo</button>
                    <button onclick="downloadChapter(${chapterNumber})" class="download-btn">📥 Shkarko</button>
                </div>
            </div>
            
            <div class="chapter-content">
                ${chapter.content}
            </div>
        `;
    } else {
        chapterContent.innerHTML = `
            <div class="chapter-header">
                <button class="back-btn" onclick="goBackToChapters()">⬅️ Kthehu te Kapitujt</button>
                <div class="chapter-info">
                    <span class="chapter-number">Kapitulli ${chapterNumber}/${totalChapters}</span>
                    <h1>${getChapterTitle(chapterNumber)}</h1>
                </div>
            </div>
            
            <div class="chapter-placeholder">
                <h2>📖 Kapitulli ${chapterNumber}: ${getChapterTitle(chapterNumber)}</h2>
                <div class="coming-soon">
                    <p>🚧 Ky kapitull është në fazën e zhvillimit dhe do të jetë i disponueshëm së shpejti.</p>
                    <p>📝 Përmbajtja e plotë do të përfshijë:</p>
                    <ul>
                        <li>📊 Analiza e detajuar e temës</li>
                        <li>💡 Shembuj praktikë nga jeta reale</li>
                        <li>🎯 Ushtrime për aplikim</li>
                        <li>📚 Referenca dhe burime shtesë</li>
                    </ul>
                </div>
            </div>
        `;
    }
    
    // Update navigation
    document.getElementById('current-chapter-display').textContent = `Kapitulli ${chapterNumber} nga ${totalChapters}`;
    document.getElementById('prev-btn').disabled = chapterNumber === 1;
    document.getElementById('next-btn').disabled = chapterNumber === totalChapters;
    
    // Update URL
    history.pushState({chapter: chapterNumber}, '', `#chapter-${chapterNumber}`);
}

function goBackToChapters() {
    const bookContentSection = document.getElementById('book-content');
    bookContentSection.style.display = 'none';
    
    const mainSections = document.querySelectorAll('#home, #about, #chapters, #testimonials, #download, #gallery');
    mainSections.forEach(sec => sec.style.display = 'block');
    document.getElementById('chapters').scrollIntoView({ behavior: 'smooth' });
}

// Navigation functions
function previousChapter() {
    if (currentChapter > 1) {
        showChapter(currentChapter - 1);
    }
}

function nextChapter() {
    if (currentChapter < totalChapters) {
        showChapter(currentChapter + 1);
    }
}

// Functions for navigation and filtering
function scrollToChapters() {
    document.getElementById('chapters').scrollIntoView({ behavior: 'smooth' });
}

function filterChapters(category) {
    const chapterCards = document.querySelectorAll('.chapter-card');
    const filterBtns = document.querySelectorAll('.filter-btn');
    
    // Update active button
    filterBtns.forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    
    // Filter chapters based on category
    chapterCards.forEach((card, index) => {
        const chapterNum = index + 1;
        let shouldShow = true;
        
        switch(category) {
            case 'basics':
                shouldShow = chapterNum >= 1 && chapterNum <= 10;
                break;
            case 'business':
                shouldShow = chapterNum >= 11 && chapterNum <= 20;
                break;
            case 'wealth':
                shouldShow = chapterNum >= 21 && chapterNum <= 30;
                break;
            case 'relationships':
                shouldShow = chapterNum >= 31 && chapterNum <= 40;
                break;
            case 'advanced':
                shouldShow = chapterNum >= 41 && chapterNum <= 60;
                break;
            case 'ai-tech':
                shouldShow = chapterNum >= 61 && chapterNum <= 80;
                break;
            case 'geopolitics':
                shouldShow = chapterNum >= 81 && chapterNum <= 100;
                break;
            case 'mastery':
                shouldShow = chapterNum >= 101 && chapterNum <= 111;
                break;
            default: // 'all'
                shouldShow = true;
        }
        
        card.style.display = shouldShow ? 'block' : 'none';
    });
}

// Load chapters on page load
document.addEventListener('DOMContentLoaded', function() {
    const chapterGrid = document.getElementById('chapterGrid');
    if (chapterGrid) {
        chapterGrid.innerHTML = ''; // Clear existing content
        
        for (let i = 1; i <= totalChapters; i++) {
            const chapterCard = document.createElement('div');
            chapterCard.className = 'chapter-card';
            chapterCard.onclick = () => showChapter(i);
            chapterCard.innerHTML = `
                <div class="chapter-number">Kapitulli ${i}</div>
                <h3>${getChapterTitle(i)}</h3>
                <p class="chapter-preview">Kliko për të lexuar përmbajtjen e plotë</p>
                <div class="chapter-status">${chapters[i] ? '✅ I Plotë' : '📝 Në Zhvillim'}</div>
            `;
            chapterGrid.appendChild(chapterCard);
        }
    }
});

// Chapter download function
function downloadChapter(chapterNumber) {
    const chapterContent = document.getElementById('chapter-content').innerHTML;
    const fullHTML = `
        <!DOCTYPE html>
        <html>
        <head>
            <title>Kapitulli ${chapterNumber} - Teoria e Lojërave</title>
            <style>
                body { font-family: Arial, sans-serif; line-height: 1.6; margin: 40px; }
                .islamic-quote { background: #f0f8ff; padding: 20px; border-left: 4px solid #4169E1; margin: 20px 0; }
                .highlight-box { background: #f9f9f9; padding: 15px; border-radius: 8px; margin: 15px 0; }
            </style>
        </head>
        <body>${chapterContent}</body>
        </html>
    `;
    
    const blob = new Blob([fullHTML], { type: 'text/html' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `Kapitulli-${chapterNumber}-Teoria-e-Lojrave.html`;
    a.click();
    URL.revokeObjectURL(url);
}

function printChapter() {
    const chapterContent = document.getElementById('chapter-content').innerHTML;
    const printWindow = window.open('', '_blank');
    printWindow.document.write(`
        <html>
        <head>
            <title>Print Chapter</title>
            <style>
                body { font-family: Arial, sans-serif; line-height: 1.6; }
                .islamic-quote { background: #f0f8ff; padding: 15px; border-left: 3px solid #4169E1; }
                .highlight-box { background: #f9f9f9; padding: 10px; border-radius: 5px; }
                @media print { body { margin: 0; } }
            </style>
        </head>
        <body>${chapterContent}</body>
        </html>
    `);
    printWindow.document.close();
    setTimeout(() => { printWindow.print(); }, 500);
}

// Download functionality
function downloadBookWithViews() {
    if (typeof window.downloadBook === 'function') {
        window.downloadBook(true);
    } else {
        alert('Download functionality është duke u ngarkuar. Ju lutemi prisni disa sekonda.');
    }
}

function downloadBookWithoutViews() {
    if (typeof window.downloadBook === 'function') {
        window.downloadBook(false);
    } else {
        alert('Download functionality është duke u ngarkuar. Ju lutemi prisni disa sekonda.');
    }
}

// Subscription functionality
function subscribeUpdates() {
    const email = document.getElementById('emailInput').value;
    if (email) {
        alert(`Faleminderit! Ju do të merrni njoftimet në: ${email}`);
        document.getElementById('emailInput').value = '';
    } else {
        alert('Ju lutemi shkruani një email valid.');
    }
}

// Show print instructions
function showPrintInstructions() {
    alert(`Udhëzime për printim:\n\n1. Hapeni një kapitull\n2. Klikoni butonin "Printo"\n3. Zgjidhni printerin dhe opsionet\n4. Printoni!`);
}

// Handle back button
window.addEventListener('popstate', function(event) {
    if (document.getElementById('book-content').style.display === 'block') {
        goBackToChapters();
    }
});

// Compatibility with other scripts
window.chapters = chapters;
window.showChapter = showChapter;
window.goBackToChapters = goBackToChapters;
window.scrollToChapters = scrollToChapters;
window.filterChapters = filterChapters;

console.log('✅ Main script loaded successfully - Ready for use!');
