<!DOCTYPE html>
<html lang="sq">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Chapter Count</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug-output { background: #f5f5f5; padding: 20px; border-radius: 5px; margin: 10px 0; }
        .chapter-list { max-height: 300px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #0056b3; }
    </style>
</head>
<body>
    <h1>Test Chapter Count - Game Theory Book</h1>
    
    <button onclick="testChapterCount()">Test Chapter Count</button>
    <button onclick="testDownload()">Test Download (Bulletproof)</button>
    <button onclick="downloadComplete()">Download Complete Book (60 Chapters)</button>
    <button onclick="showAllChapters()">Show All Chapter Titles</button>
    
    <div id="output" class="debug-output">
        Click the buttons above to test chapter functionality.
    </div>
    
    <div id="chapter-list" class="chapter-list" style="display: none;">
        <!-- Chapter titles will be displayed here -->
    </div>

    <!-- Include the main script -->
    <script src="script.js"></script>
    
    <!-- Include the bulletproof download -->
    <script src="bulletproof-download.js"></script>
    
    <!-- Include the complete book download -->
    <script src="download-complete-book.js"></script>
    
    <script>
        function testChapterCount() {
            const output = document.getElementById('output');
            
            let debugInfo = `
                <h3>üîç Chapter Count Debug Information</h3>
                <p><strong>totalChapters variable:</strong> ${typeof totalChapters !== 'undefined' ? totalChapters : 'undefined'}</p>
                <p><strong>window.totalChapters:</strong> ${window.totalChapters}</p>
                <p><strong>chapters object:</strong> ${typeof chapters !== 'undefined' ? 'defined' : 'undefined'}</p>
                <p><strong>window.chapters:</strong> ${typeof window.chapters !== 'undefined' ? 'defined' : 'undefined'}</p>
            `;
            
            if (typeof window.chapters !== 'undefined') {
                const chapterKeys = Object.keys(window.chapters);
                debugInfo += `
                    <p><strong>Number of chapters in window.chapters:</strong> ${chapterKeys.length}</p>
                    <p><strong>Chapter keys:</strong> ${chapterKeys.join(', ')}</p>
                `;
            }
            
            debugInfo += `
                <p><strong>getChapterTitle function:</strong> ${typeof window.getChapterTitle}</p>
                <p><strong>generateChapterContent function:</strong> ${typeof window.generateChapterContent}</p>
            `;
            
            // Test getting titles for all 60 chapters
            if (typeof window.getChapterTitle === 'function') {
                debugInfo += `<h4>üìö Testing getChapterTitle function:</h4>`;
                let titleTest = '<ul>';
                for (let i = 1; i <= 10; i++) { // Test first 10
                    try {
                        const title = window.getChapterTitle(i);
                        titleTest += `<li><strong>Chapter ${i}:</strong> ${title}</li>`;
                    } catch (error) {
                        titleTest += `<li><strong>Chapter ${i}:</strong> Error - ${error.message}</li>`;
                    }
                }
                titleTest += '</ul>';
                debugInfo += titleTest;
            }
            
            output.innerHTML = debugInfo;
        }
        
        function testDownload() {
            const output = document.getElementById('output');
            output.innerHTML = '<h3>üöÄ Testing download...</h3><p>Check the console for detailed logs.</p>';
            
            // Run the bulletproof download
            if (typeof window.bulletproofDownloadBook === 'function') {
                window.bulletproofDownloadBook();
            } else if (typeof window.testBulletproofDownload === 'function') {
                window.testBulletproofDownload();
            } else {
                output.innerHTML += '<p style="color: red;">‚ùå Download function not found!</p>';
            }
        }
        
        function showAllChapters() {
            const chapterList = document.getElementById('chapter-list');
            const output = document.getElementById('output');
            
            if (typeof window.getChapterTitle === 'function') {
                let chaptersHtml = '<h3>üìñ All Chapter Titles (1-60)</h3><ol>';
                
                for (let i = 1; i <= 60; i++) {
                    try {
                        const title = window.getChapterTitle(i);
                        chaptersHtml += `<li><strong>Kapitulli ${i}:</strong> ${title}</li>`;
                    } catch (error) {
                        chaptersHtml += `<li><strong>Kapitulli ${i}:</strong> <span style="color: red;">Error - ${error.message}</span></li>`;
                    }
                }
                
                chaptersHtml += '</ol>';
                chapterList.innerHTML = chaptersHtml;
                chapterList.style.display = 'block';
                
                output.innerHTML = '<h3>‚úÖ Chapter titles loaded successfully!</h3><p>All 60 chapter titles are displayed below.</p>';
            } else {
                output.innerHTML = '<h3>‚ùå Error</h3><p>getChapterTitle function not found!</p>';
            }
        }
        
        function downloadComplete() {
            const output = document.getElementById('output');
            output.innerHTML = '<h3>üìö Downloading complete book with 60 chapters...</h3><p>Check the console for detailed logs.</p>';
            
            // Run the complete download
            if (typeof window.downloadCompleteBook === 'function') {
                window.downloadCompleteBook();
            } else {
                output.innerHTML += '<p style="color: red;">‚ùå Complete download function not found!</p>';
            }
        }
        
        // Auto-run the test when page loads
        window.addEventListener('load', function() {
            setTimeout(testChapterCount, 1000);
        });
    </script>
</body>
</html>
